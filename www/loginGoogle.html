<!DOCTYPE html>
<html>
    <head>
          <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
          <meta http-equiv="Content-Security-Policy" content="script-src 'self' *.google.com https://*.googleapis.com https://maps.gstatic.com https://drive.google.com 'unsafe-eval' 'unsafe-inline'; object-src 'self'">
          <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0"/>
          <title>e-Ticket</title>
          <!-- CSS  -->
          <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
          <link href="css/materialize.css" type="text/css" rel="stylesheet" media="screen,projection"/>
          <link href="css/style.css" type="text/css" rel="stylesheet" media="screen,projection"/>

          <title>e-Ticket</title>
    </head>
    <body>
        <nav class="green lighten-1" role="navigation">
            <div class="nav-wrapper container"><a id="logo-container" href="#" class="brand-logo">e-Ticket</a>
                <ul class="right hide-on-med-and-down">
                    <li><a href="clientEdit">Client Profile</a></li>
                    <li><a href="cartReady.html">Cart</a></li>
                    <li><a href="purchaseHome.html">Purchases</a></li>
                    <li><a href="productHome.html">Products</a></li>
                    <li><a href="storeHome.html">Stores</a></li>
                    <li><a href="storeMap.html">Store Map</a></li>

                </ul>
                <ul id="nav-mobile" class="side-nav">
                    <li><a href="clientEdit">Client Profile</a></li>
                    <li><a href="cartReady.html">Cart</a></li>
                    <li><a href="purchaseHome.html">Purchases</a></li>
                    <li><a href="productHome.html">Products</a></li>
                    <li><a href="storeHome.html">Stores</a></li>
                    <li><a href="storeMap.html">Store Map</a></li>
                </ul>
                <a href="#" data-activates="nav-mobile" class="button-collapse"><i class="material-icons">menu</i></a>
            </div>
        </nav>
        <div class="section no-pad-bot" id="index-banner">
            <div class="container">
                <h3 class="header center orange-text">Google +</h3>
            </div>
        </div>

        <div class="container">
        	<img id="image" style="top:100px; left:100px" src="" />
            <p class="event listening">Connecting to Device</p>
            <p class="event received">Device is Ready</p>

            <p id="feedback">not logged in</p>
            <!--button onclick="isAvailable()">Available?</button-->
            <a class="waves-effect waves-light btn" onclick="isAvailable()">Servicio disponible</a>
            <br/>
            <a class="waves-effect waves-light btn red" onclick="login()">Login con Google+</a>
            <br/>
            <a class="waves-effect waves-light btn orange"  onclick="trySilentLogin()">Silent login con Google+</a>
            <br/>
            <a class="waves-effect waves-light btn black"  onclick="logout()">Logout</a>
            <br/>
            <a class="waves-effect waves-light btn yellow"  onclick="disconnect()">Desconectar</a>

        </div>

        <footer class="page-footer orange">
    	     <div class="footer-copyright">
                 <div class="container">
                     e-Ticket
                 </div>
             </div>
         </footer>

         <!--  Scripts-->
         <script src="cordova.js"></script>
         <script src="js/jquery-2.1.3.min.js"></script>
         <script src="js/materialize.js"></script>
         <script type="text/javascript">
             //app.initialize();
             function isAvailable() {
                 window.plugins.googleplus.isAvailable(function(avail) {
                     alert(avail)
                 });
             }
             function login() {
                 window.plugins.googleplus.login(
                     {
                         'iOSApiKey': '6535513912-uvpf249ak7avodois85tkjmh2lc2j952.apps.googleusercontent.com'
                     },
                     function (obj) {
                         document.querySelector("#image").src = obj.imageUrl;
                         document.querySelector("#image").style.visibility = 'visible';
                         document.querySelector("#feedback").innerHTML = "Hi, " + obj.displayName + ", " + obj.email;
                         console.log(obj);
                     },
                     function (msg) {
                         document.querySelector("#feedback").innerHTML = "error: " + msg;
                         console.error(msg);
                     }
                 );
                 }
             function trySilentLogin() {
                 window.plugins.googleplus.trySilentLogin(
                     {
                         'iOSApiKey': '6535513912-uvpf249ak7avodois85tkjmh2lc2j952.apps.googleusercontent.com'
                     },
                     function (obj) {
                         document.querySelector("#image").src = obj.imageUrl;
                         document.querySelector("#image").style.visibility = 'visible';
                         document.querySelector("#feedback").innerHTML = "Silent hi, " + obj.displayName + ", " + obj.email;
                     },
                     function (msg) {
                         document.querySelector("#feedback").innerHTML = "error: " + msg;
                     }
                 );
             }
             function logout() {
                 window.plugins.googleplus.logout(
                     function (msg) {
                         document.querySelector("#image").style.visibility = 'hidden';
                         document.querySelector("#feedback").innerHTML = msg;
                     }
                 );
             }
             function disconnect() {
                 window.plugins.googleplus.disconnect(
                     function (msg) {
                         document.querySelector("#image").style.visibility = 'hidden';
                         document.querySelector("#feedback").innerHTML = msg;
                     }
                 );
             }
             window.onerror = function(what, line, file) {
                 alert(what + '; ' + line + '; ' + file);
             };
             function handleOpenURL (url) {
                 document.querySelector("#feedback").innerHTML = "App was opened by URL: " + url;
             }
         </script>
    </body>
</html>
